/*
OpenWeatherMap.org
*/

// Toggle Weather Forecast Window
document.getElementById('weatherWindow').addEventListener('click', function() {
  if ($(".weatherInfoWindow").is( ":hidden" )) {
      $(".weatherInfoWindow").slideDown();
    } else {
      $(".weatherInfoWindow").slideUp();
    }
  $(".weatherInfoButton").find("span").toggleClass('glyphicon-menu-down').toggleClass('glyphicon-menu-up');
});

// var owmR = new owmResponse({"city":{"id":5370006,"name":"Mammoth Lakes","coord":{"lon":-118.972076,"lat":37.648548},"country":"US","population":0,"sys":{"population":0}},"cod":"200","message":0.0098,"cnt":37,"list":[{"dt":1487667600,"main":{"temp":274.12,"temp_min":274.118,"temp_max":274.12,"pressure":773.08,"sea_level":1030.9,"grnd_level":773.08,"humidity":87,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10n"}],"clouds":{"all":80},"wind":{"speed":5.56,"deg":214.501},"rain":{"3h":0.9},"snow":{"3h":0.8405},"sys":{"pod":"n"},"dt_txt":"2017-02-21 09:00:00"},{"dt":1487678400,"main":{"temp":274.82,"temp_min":274.82,"temp_max":274.821,"pressure":773.19,"sea_level":1031.34,"grnd_level":773.19,"humidity":79,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10n"}],"clouds":{"all":48},"wind":{"speed":6.45,"deg":223},"rain":{"3h":0.93},"snow":{"3h":0.1375},"sys":{"pod":"n"},"dt_txt":"2017-02-21 12:00:00"},{"dt":1487689200,"main":{"temp":273.21,"temp_min":273.207,"temp_max":273.21,"pressure":774.19,"sea_level":1033.3,"grnd_level":774.19,"humidity":75,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"clouds":{"all":44},"wind":{"speed":5.48,"deg":226.5},"rain":{"3h":0.025},"snow":{"3h":0.07},"sys":{"pod":"d"},"dt_txt":"2017-02-21 15:00:00"},{"dt":1487700000,"main":{"temp":274.5,"temp_min":274.498,"temp_max":274.5,"pressure":775.52,"sea_level":1034.17,"grnd_level":775.52,"humidity":77,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"clouds":{"all":44},"wind":{"speed":5.01,"deg":222.008},"rain":{"3h":0.19},"snow":{"3h":0.22},"sys":{"pod":"d"},"dt_txt":"2017-02-21 18:00:00"},{"dt":1487710800,"main":{"temp":274.292,"temp_min":274.292,"temp_max":274.292,"pressure":775.38,"sea_level":1032.76,"grnd_level":775.38,"humidity":73,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":5.16,"deg":227.505},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2017-02-21 21:00:00"},{"dt":1487721600,"main":{"temp":273.351,"temp_min":273.351,"temp_max":273.351,"pressure":774.54,"sea_level":1031.67,"grnd_level":774.54,"humidity":70,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":4.16,"deg":226.501},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-22 00:00:00"},{"dt":1487732400,"main":{"temp":272.287,"temp_min":272.287,"temp_max":272.287,"pressure":774.02,"sea_level":1032.12,"grnd_level":774.02,"humidity":69,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":24},"wind":{"speed":4.22,"deg":217.001},"rain":{},"snow":{"3h":0.015},"sys":{"pod":"n"},"dt_txt":"2017-02-22 03:00:00"},{"dt":1487743200,"main":{"temp":270.441,"temp_min":270.441,"temp_max":270.441,"pressure":773.69,"sea_level":1032.58,"grnd_level":773.69,"humidity":72,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10n"}],"clouds":{"all":0},"wind":{"speed":3.21,"deg":211.5},"rain":{"3h":0.005},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-22 06:00:00"},{"dt":1487754000,"main":{"temp":269.898,"temp_min":269.898,"temp_max":269.898,"pressure":771.86,"sea_level":1031.17,"grnd_level":771.86,"humidity":74,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":3.56,"deg":211.001},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-22 09:00:00"},{"dt":1487764800,"main":{"temp":269.02,"temp_min":269.02,"temp_max":269.02,"pressure":769.77,"sea_level":1029.3,"grnd_level":769.77,"humidity":71,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":8},"wind":{"speed":3.25,"deg":205.504},"rain":{},"snow":{"3h":0.0025},"sys":{"pod":"n"},"dt_txt":"2017-02-22 12:00:00"},{"dt":1487775600,"main":{"temp":268.625,"temp_min":268.625,"temp_max":268.625,"pressure":768.19,"sea_level":1028.2,"grnd_level":768.19,"humidity":73,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13d"}],"clouds":{"all":24},"wind":{"speed":2.66,"deg":210.51},"rain":{},"snow":{"3h":0.05},"sys":{"pod":"d"},"dt_txt":"2017-02-22 15:00:00"},{"dt":1487786400,"main":{"temp":272.195,"temp_min":272.195,"temp_max":272.195,"pressure":767.4,"sea_level":1026.67,"grnd_level":767.4,"humidity":77,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13d"}],"clouds":{"all":80},"wind":{"speed":2.42,"deg":228.005},"rain":{},"snow":{"3h":0.5825},"sys":{"pod":"d"},"dt_txt":"2017-02-22 18:00:00"},{"dt":1487797200,"main":{"temp":271.821,"temp_min":271.821,"temp_max":271.821,"pressure":765.78,"sea_level":1024.71,"grnd_level":765.78,"humidity":75,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13d"}],"clouds":{"all":56},"wind":{"speed":2.77,"deg":230.505},"rain":{},"snow":{"3h":0.1825},"sys":{"pod":"d"},"dt_txt":"2017-02-22 21:00:00"},{"dt":1487808000,"main":{"temp":269.74,"temp_min":269.74,"temp_max":269.74,"pressure":764.79,"sea_level":1024.7,"grnd_level":764.79,"humidity":80,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13n"}],"clouds":{"all":88},"wind":{"speed":1.46,"deg":294.501},"rain":{},"snow":{"3h":1.14},"sys":{"pod":"n"},"dt_txt":"2017-02-23 00:00:00"},{"dt":1487818800,"main":{"temp":265.922,"temp_min":265.922,"temp_max":265.922,"pressure":766.05,"sea_level":1028.63,"grnd_level":766.05,"humidity":79,"temp_kf":0},"weather":[{"id":601,"main":"Snow","description":"snow","icon":"13n"}],"clouds":{"all":44},"wind":{"speed":2.21,"deg":276.501},"rain":{},"snow":{"3h":3.2075},"sys":{"pod":"n"},"dt_txt":"2017-02-23 03:00:00"},{"dt":1487829600,"main":{"temp":260.432,"temp_min":260.432,"temp_max":260.432,"pressure":766.38,"sea_level":1030.75,"grnd_level":766.38,"humidity":75,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":2.27,"deg":242.513},"rain":{},"snow":{"3h":0.015},"sys":{"pod":"n"},"dt_txt":"2017-02-23 06:00:00"},{"dt":1487840400,"main":{"temp":259.421,"temp_min":259.421,"temp_max":259.421,"pressure":766.22,"sea_level":1031.46,"grnd_level":766.22,"humidity":81,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":2.42,"deg":234},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-23 09:00:00"},{"dt":1487851200,"main":{"temp":256.714,"temp_min":256.714,"temp_max":256.714,"pressure":767.05,"sea_level":1033.21,"grnd_level":767.05,"humidity":80,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.18,"deg":232.503},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-23 12:00:00"},{"dt":1487862000,"main":{"temp":254.399,"temp_min":254.399,"temp_max":254.399,"pressure":768.28,"sea_level":1035.48,"grnd_level":768.28,"humidity":79,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":1.08,"deg":241.001},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2017-02-23 15:00:00"},{"dt":1487872800,"main":{"temp":264.88,"temp_min":264.88,"temp_max":264.88,"pressure":769.4,"sea_level":1034.8,"grnd_level":769.4,"humidity":75,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":1.28,"deg":245.004},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2017-02-23 18:00:00"},{"dt":1487883600,"main":{"temp":268.512,"temp_min":268.512,"temp_max":268.512,"pressure":768.62,"sea_level":1032.21,"grnd_level":768.62,"humidity":74,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":1.15,"deg":283.001},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2017-02-23 21:00:00"},{"dt":1487894400,"main":{"temp":268.363,"temp_min":268.363,"temp_max":268.363,"pressure":768.35,"sea_level":1031.49,"grnd_level":768.35,"humidity":69,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.45,"deg":271.5},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-24 00:00:00"},{"dt":1487905200,"main":{"temp":260.485,"temp_min":260.485,"temp_max":260.485,"pressure":769.04,"sea_level":1033.56,"grnd_level":769.04,"humidity":69,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.07,"deg":259.506},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-24 03:00:00"},{"dt":1487916000,"main":{"temp":255.838,"temp_min":255.838,"temp_max":255.838,"pressure":769.52,"sea_level":1035.49,"grnd_level":769.52,"humidity":78,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"02n"}],"clouds":{"all":8},"wind":{"speed":0.86,"deg":237.002},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-24 06:00:00"},{"dt":1487926800,"main":{"temp":254.89,"temp_min":254.89,"temp_max":254.89,"pressure":769.43,"sea_level":1036.43,"grnd_level":769.43,"humidity":76,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":0.97,"deg":233.001},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-24 09:00:00"},{"dt":1487937600,"main":{"temp":253.615,"temp_min":253.615,"temp_max":253.615,"pressure":768.78,"sea_level":1036.24,"grnd_level":768.78,"humidity":66,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.11,"deg":234.5},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-24 12:00:00"},{"dt":1487948400,"main":{"temp":252.793,"temp_min":252.793,"temp_max":252.793,"pressure":768.95,"sea_level":1037.22,"grnd_level":768.95,"humidity":71,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":1.07,"deg":237.501},"rain":{},"snow":{"3h":0.005},"sys":{"pod":"d"},"dt_txt":"2017-02-24 15:00:00"},{"dt":1487959200,"main":{"temp":265,"temp_min":265,"temp_max":265,"pressure":769.65,"sea_level":1035.35,"grnd_level":769.65,"humidity":67,"temp_kf":0},"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02d"}],"clouds":{"all":20},"wind":{"speed":1.12,"deg":244.502},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2017-02-24 18:00:00"},{"dt":1487970000,"main":{"temp":269.175,"temp_min":269.175,"temp_max":269.175,"pressure":768.81,"sea_level":1031.78,"grnd_level":768.81,"humidity":70,"temp_kf":0},"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02d"}],"clouds":{"all":24},"wind":{"speed":1.52,"deg":269.501},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2017-02-24 21:00:00"},{"dt":1487980800,"main":{"temp":268.297,"temp_min":268.297,"temp_max":268.297,"pressure":768.27,"sea_level":1030.42,"grnd_level":768.27,"humidity":66,"temp_kf":0},"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02n"}],"clouds":{"all":20},"wind":{"speed":2.1,"deg":251.004},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-25 00:00:00"},{"dt":1487991600,"main":{"temp":261.414,"temp_min":261.414,"temp_max":261.414,"pressure":768.31,"sea_level":1031.93,"grnd_level":768.31,"humidity":64,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],"clouds":{"all":32},"wind":{"speed":1.46,"deg":218.002},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-25 03:00:00"},{"dt":1488002400,"main":{"temp":257.228,"temp_min":257.228,"temp_max":257.228,"pressure":768.57,"sea_level":1033.32,"grnd_level":768.57,"humidity":77,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.96,"deg":205.002},"rain":{},"snow":{"3h":0.0025},"sys":{"pod":"n"},"dt_txt":"2017-02-25 06:00:00"},{"dt":1488013200,"main":{"temp":254.456,"temp_min":254.456,"temp_max":254.456,"pressure":767.2,"sea_level":1032.31,"grnd_level":767.2,"humidity":61,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.45,"deg":193.504},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-25 09:00:00"},{"dt":1488024000,"main":{"temp":255.124,"temp_min":255.124,"temp_max":255.124,"pressure":766.4,"sea_level":1031.86,"grnd_level":766.4,"humidity":74,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13n"}],"clouds":{"all":48},"wind":{"speed":1.52,"deg":230.501},"rain":{},"snow":{"3h":0.0625},"sys":{"pod":"n"},"dt_txt":"2017-02-25 12:00:00"},{"dt":1488034800,"main":{"temp":257.816,"temp_min":257.816,"temp_max":257.816,"pressure":765.95,"sea_level":1032.12,"grnd_level":765.95,"humidity":79,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13d"}],"clouds":{"all":68},"wind":{"speed":1.07,"deg":227.002},"rain":{},"snow":{"3h":0.4175},"sys":{"pod":"d"},"dt_txt":"2017-02-25 15:00:00"},{"dt":1488045600,"main":{"temp":265.711,"temp_min":265.711,"temp_max":265.711,"pressure":766.27,"sea_level":1030.44,"grnd_level":766.27,"humidity":77,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13d"}],"clouds":{"all":68},"wind":{"speed":1.21,"deg":187},"rain":{},"snow":{"3h":0.5},"sys":{"pod":"d"},"dt_txt":"2017-02-25 18:00:00"},{"dt":1488056400,"main":{"temp":268.065,"temp_min":268.065,"temp_max":268.065,"pressure":764.8,"sea_level":1026.85,"grnd_level":764.8,"humidity":79,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13d"}],"clouds":{"all":76},"wind":{"speed":1.3,"deg":237},"rain":{},"snow":{"3h":0.33},"sys":{"pod":"d"},"dt_txt":"2017-02-25 21:00:00"}]});
// var owmJsonp = ?({"city":{"id":5370006,"name":"Mammoth Lakes","coord":{"lon":-118.972076,"lat":37.648548},"country":"US","population":0,"sys":{"population":0}},"cod":"200","message":0.0098,"cnt":37,"list":[{"dt":1487667600,"main":{"temp":274.12,"temp_min":274.118,"temp_max":274.12,"pressure":773.08,"sea_level":1030.9,"grnd_level":773.08,"humidity":87,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10n"}],"clouds":{"all":80},"wind":{"speed":5.56,"deg":214.501},"rain":{"3h":0.9},"snow":{"3h":0.8405},"sys":{"pod":"n"},"dt_txt":"2017-02-21 09:00:00"},{"dt":1487678400,"main":{"temp":274.82,"temp_min":274.82,"temp_max":274.821,"pressure":773.19,"sea_level":1031.34,"grnd_level":773.19,"humidity":79,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10n"}],"clouds":{"all":48},"wind":{"speed":6.45,"deg":223},"rain":{"3h":0.93},"snow":{"3h":0.1375},"sys":{"pod":"n"},"dt_txt":"2017-02-21 12:00:00"},{"dt":1487689200,"main":{"temp":273.21,"temp_min":273.207,"temp_max":273.21,"pressure":774.19,"sea_level":1033.3,"grnd_level":774.19,"humidity":75,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"clouds":{"all":44},"wind":{"speed":5.48,"deg":226.5},"rain":{"3h":0.025},"snow":{"3h":0.07},"sys":{"pod":"d"},"dt_txt":"2017-02-21 15:00:00"},{"dt":1487700000,"main":{"temp":274.5,"temp_min":274.498,"temp_max":274.5,"pressure":775.52,"sea_level":1034.17,"grnd_level":775.52,"humidity":77,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"clouds":{"all":44},"wind":{"speed":5.01,"deg":222.008},"rain":{"3h":0.19},"snow":{"3h":0.22},"sys":{"pod":"d"},"dt_txt":"2017-02-21 18:00:00"},{"dt":1487710800,"main":{"temp":274.292,"temp_min":274.292,"temp_max":274.292,"pressure":775.38,"sea_level":1032.76,"grnd_level":775.38,"humidity":73,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":5.16,"deg":227.505},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2017-02-21 21:00:00"},{"dt":1487721600,"main":{"temp":273.351,"temp_min":273.351,"temp_max":273.351,"pressure":774.54,"sea_level":1031.67,"grnd_level":774.54,"humidity":70,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":4.16,"deg":226.501},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-22 00:00:00"},{"dt":1487732400,"main":{"temp":272.287,"temp_min":272.287,"temp_max":272.287,"pressure":774.02,"sea_level":1032.12,"grnd_level":774.02,"humidity":69,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":24},"wind":{"speed":4.22,"deg":217.001},"rain":{},"snow":{"3h":0.015},"sys":{"pod":"n"},"dt_txt":"2017-02-22 03:00:00"},{"dt":1487743200,"main":{"temp":270.441,"temp_min":270.441,"temp_max":270.441,"pressure":773.69,"sea_level":1032.58,"grnd_level":773.69,"humidity":72,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10n"}],"clouds":{"all":0},"wind":{"speed":3.21,"deg":211.5},"rain":{"3h":0.005},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-22 06:00:00"},{"dt":1487754000,"main":{"temp":269.898,"temp_min":269.898,"temp_max":269.898,"pressure":771.86,"sea_level":1031.17,"grnd_level":771.86,"humidity":74,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":3.56,"deg":211.001},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-22 09:00:00"},{"dt":1487764800,"main":{"temp":269.02,"temp_min":269.02,"temp_max":269.02,"pressure":769.77,"sea_level":1029.3,"grnd_level":769.77,"humidity":71,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":8},"wind":{"speed":3.25,"deg":205.504},"rain":{},"snow":{"3h":0.0025},"sys":{"pod":"n"},"dt_txt":"2017-02-22 12:00:00"},{"dt":1487775600,"main":{"temp":268.625,"temp_min":268.625,"temp_max":268.625,"pressure":768.19,"sea_level":1028.2,"grnd_level":768.19,"humidity":73,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13d"}],"clouds":{"all":24},"wind":{"speed":2.66,"deg":210.51},"rain":{},"snow":{"3h":0.05},"sys":{"pod":"d"},"dt_txt":"2017-02-22 15:00:00"},{"dt":1487786400,"main":{"temp":272.195,"temp_min":272.195,"temp_max":272.195,"pressure":767.4,"sea_level":1026.67,"grnd_level":767.4,"humidity":77,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13d"}],"clouds":{"all":80},"wind":{"speed":2.42,"deg":228.005},"rain":{},"snow":{"3h":0.5825},"sys":{"pod":"d"},"dt_txt":"2017-02-22 18:00:00"},{"dt":1487797200,"main":{"temp":271.821,"temp_min":271.821,"temp_max":271.821,"pressure":765.78,"sea_level":1024.71,"grnd_level":765.78,"humidity":75,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13d"}],"clouds":{"all":56},"wind":{"speed":2.77,"deg":230.505},"rain":{},"snow":{"3h":0.1825},"sys":{"pod":"d"},"dt_txt":"2017-02-22 21:00:00"},{"dt":1487808000,"main":{"temp":269.74,"temp_min":269.74,"temp_max":269.74,"pressure":764.79,"sea_level":1024.7,"grnd_level":764.79,"humidity":80,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13n"}],"clouds":{"all":88},"wind":{"speed":1.46,"deg":294.501},"rain":{},"snow":{"3h":1.14},"sys":{"pod":"n"},"dt_txt":"2017-02-23 00:00:00"},{"dt":1487818800,"main":{"temp":265.922,"temp_min":265.922,"temp_max":265.922,"pressure":766.05,"sea_level":1028.63,"grnd_level":766.05,"humidity":79,"temp_kf":0},"weather":[{"id":601,"main":"Snow","description":"snow","icon":"13n"}],"clouds":{"all":44},"wind":{"speed":2.21,"deg":276.501},"rain":{},"snow":{"3h":3.2075},"sys":{"pod":"n"},"dt_txt":"2017-02-23 03:00:00"},{"dt":1487829600,"main":{"temp":260.432,"temp_min":260.432,"temp_max":260.432,"pressure":766.38,"sea_level":1030.75,"grnd_level":766.38,"humidity":75,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":2.27,"deg":242.513},"rain":{},"snow":{"3h":0.015},"sys":{"pod":"n"},"dt_txt":"2017-02-23 06:00:00"},{"dt":1487840400,"main":{"temp":259.421,"temp_min":259.421,"temp_max":259.421,"pressure":766.22,"sea_level":1031.46,"grnd_level":766.22,"humidity":81,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":2.42,"deg":234},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-23 09:00:00"},{"dt":1487851200,"main":{"temp":256.714,"temp_min":256.714,"temp_max":256.714,"pressure":767.05,"sea_level":1033.21,"grnd_level":767.05,"humidity":80,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.18,"deg":232.503},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-23 12:00:00"},{"dt":1487862000,"main":{"temp":254.399,"temp_min":254.399,"temp_max":254.399,"pressure":768.28,"sea_level":1035.48,"grnd_level":768.28,"humidity":79,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":1.08,"deg":241.001},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2017-02-23 15:00:00"},{"dt":1487872800,"main":{"temp":264.88,"temp_min":264.88,"temp_max":264.88,"pressure":769.4,"sea_level":1034.8,"grnd_level":769.4,"humidity":75,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":1.28,"deg":245.004},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2017-02-23 18:00:00"},{"dt":1487883600,"main":{"temp":268.512,"temp_min":268.512,"temp_max":268.512,"pressure":768.62,"sea_level":1032.21,"grnd_level":768.62,"humidity":74,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":1.15,"deg":283.001},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2017-02-23 21:00:00"},{"dt":1487894400,"main":{"temp":268.363,"temp_min":268.363,"temp_max":268.363,"pressure":768.35,"sea_level":1031.49,"grnd_level":768.35,"humidity":69,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.45,"deg":271.5},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-24 00:00:00"},{"dt":1487905200,"main":{"temp":260.485,"temp_min":260.485,"temp_max":260.485,"pressure":769.04,"sea_level":1033.56,"grnd_level":769.04,"humidity":69,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.07,"deg":259.506},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-24 03:00:00"},{"dt":1487916000,"main":{"temp":255.838,"temp_min":255.838,"temp_max":255.838,"pressure":769.52,"sea_level":1035.49,"grnd_level":769.52,"humidity":78,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"02n"}],"clouds":{"all":8},"wind":{"speed":0.86,"deg":237.002},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-24 06:00:00"},{"dt":1487926800,"main":{"temp":254.89,"temp_min":254.89,"temp_max":254.89,"pressure":769.43,"sea_level":1036.43,"grnd_level":769.43,"humidity":76,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":0.97,"deg":233.001},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-24 09:00:00"},{"dt":1487937600,"main":{"temp":253.615,"temp_min":253.615,"temp_max":253.615,"pressure":768.78,"sea_level":1036.24,"grnd_level":768.78,"humidity":66,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.11,"deg":234.5},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-24 12:00:00"},{"dt":1487948400,"main":{"temp":252.793,"temp_min":252.793,"temp_max":252.793,"pressure":768.95,"sea_level":1037.22,"grnd_level":768.95,"humidity":71,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":1.07,"deg":237.501},"rain":{},"snow":{"3h":0.005},"sys":{"pod":"d"},"dt_txt":"2017-02-24 15:00:00"},{"dt":1487959200,"main":{"temp":265,"temp_min":265,"temp_max":265,"pressure":769.65,"sea_level":1035.35,"grnd_level":769.65,"humidity":67,"temp_kf":0},"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02d"}],"clouds":{"all":20},"wind":{"speed":1.12,"deg":244.502},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2017-02-24 18:00:00"},{"dt":1487970000,"main":{"temp":269.175,"temp_min":269.175,"temp_max":269.175,"pressure":768.81,"sea_level":1031.78,"grnd_level":768.81,"humidity":70,"temp_kf":0},"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02d"}],"clouds":{"all":24},"wind":{"speed":1.52,"deg":269.501},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2017-02-24 21:00:00"},{"dt":1487980800,"main":{"temp":268.297,"temp_min":268.297,"temp_max":268.297,"pressure":768.27,"sea_level":1030.42,"grnd_level":768.27,"humidity":66,"temp_kf":0},"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02n"}],"clouds":{"all":20},"wind":{"speed":2.1,"deg":251.004},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-25 00:00:00"},{"dt":1487991600,"main":{"temp":261.414,"temp_min":261.414,"temp_max":261.414,"pressure":768.31,"sea_level":1031.93,"grnd_level":768.31,"humidity":64,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],"clouds":{"all":32},"wind":{"speed":1.46,"deg":218.002},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-25 03:00:00"},{"dt":1488002400,"main":{"temp":257.228,"temp_min":257.228,"temp_max":257.228,"pressure":768.57,"sea_level":1033.32,"grnd_level":768.57,"humidity":77,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.96,"deg":205.002},"rain":{},"snow":{"3h":0.0025},"sys":{"pod":"n"},"dt_txt":"2017-02-25 06:00:00"},{"dt":1488013200,"main":{"temp":254.456,"temp_min":254.456,"temp_max":254.456,"pressure":767.2,"sea_level":1032.31,"grnd_level":767.2,"humidity":61,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.45,"deg":193.504},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2017-02-25 09:00:00"},{"dt":1488024000,"main":{"temp":255.124,"temp_min":255.124,"temp_max":255.124,"pressure":766.4,"sea_level":1031.86,"grnd_level":766.4,"humidity":74,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13n"}],"clouds":{"all":48},"wind":{"speed":1.52,"deg":230.501},"rain":{},"snow":{"3h":0.0625},"sys":{"pod":"n"},"dt_txt":"2017-02-25 12:00:00"},{"dt":1488034800,"main":{"temp":257.816,"temp_min":257.816,"temp_max":257.816,"pressure":765.95,"sea_level":1032.12,"grnd_level":765.95,"humidity":79,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13d"}],"clouds":{"all":68},"wind":{"speed":1.07,"deg":227.002},"rain":{},"snow":{"3h":0.4175},"sys":{"pod":"d"},"dt_txt":"2017-02-25 15:00:00"},{"dt":1488045600,"main":{"temp":265.711,"temp_min":265.711,"temp_max":265.711,"pressure":766.27,"sea_level":1030.44,"grnd_level":766.27,"humidity":77,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13d"}],"clouds":{"all":68},"wind":{"speed":1.21,"deg":187},"rain":{},"snow":{"3h":0.5},"sys":{"pod":"d"},"dt_txt":"2017-02-25 18:00:00"},{"dt":1488056400,"main":{"temp":268.065,"temp_min":268.065,"temp_max":268.065,"pressure":764.8,"sea_level":1026.85,"grnd_level":764.8,"humidity":79,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13d"}],"clouds":{"all":76},"wind":{"speed":1.3,"deg":237},"rain":{},"snow":{"3h":0.33},"sys":{"pod":"d"},"dt_txt":"2017-02-25 21:00:00"}]});
var owmIconUrl = "http://openweathermap.org/img/w/";
var ownLocationZip = "93546,us";  // Mammoth Lakes, CA
var owmCityId = 5370006;  // Mammmoth Lakes, CA
var owmKey = "363a750eba84b06b38896944ddd563f9";
var owmUrl = "http://api.openweathermap.org/data/2.5/forecast?id=" + owmCityId + "&APPID=" + owmKey;

// Weather Model for KnockoutJS
// This function takes the 5-day forecast result from Open Weather Map API call
// as an argument and creates a ko.observableArray to display the weather
var weatherModel = function() {

    // Calls the Open Weather Maps 5-day Forecast API and sets the response and the time of
    // the call to localStorage.
    function getWeatherForecast() {
        // $.getJSON( owmUrl, function(response) {
        //     console.log(response);
        //     localStorage.owmResponse = response;
        //     console.log('Retrieving OWM weather data...');
        //     localStorage.owmWeatherForecast = JSON.stringify(response);
        //     localStorage.owmCallTime = Date.now();
        // }).error(function() {
        //     console.log('Cannot retrieve weather data...');
        //     return null;
        // });
        console.log('ajax call...');
        $.ajax({
            url: owmUrl,
            dataType: "jsonp",
            success: function(response) {
                console.log(response);
                localStorage.owmWeatherForecast = JSON.stringify(response);
                localStorage.owmCallTime = Date.now();
            }
        });
    }

    // Use of the Open Weather Map API is limited therefore, calls to the API are limited to once every
    // three hours
    // If localStorage variables are null; invoke getWeatherForecast()
    if (( typeof(localStorage.owmCallTime) === 'undefined' ) ||
        ( typeof(localStorage.owmWeatherForecast) === 'undefined' )) {
        console.log('Initializing OWM Forecast data...');
        getWeatherForecast();
    } else {
        // If forecast was last updated 3 hours ago (10800000 ms), invoke getWeatherForecast();
        // Otherwise, notify through the console.
        var timeDifference = Date.now() - localStorage.owmCallTime;
        if ( timeDifference > 10800000 ) {
            console.log('Forecast data expired. Updating...');
            getWeatherForecast();
        } else {
            console.log('Forecast data is current...');
            console.log('Last updated: ', new Date(JSON.parse(localStorage.owmCallTime)));
        }
    }


    var weatherData = JSON.parse(localStorage.owmWeatherForecast);
    var weatherArray = ko.observableArray();
    var weatherForecast = weatherData.list;

    // Get forecast information from weather data. 8 weather points are taken per day,
    // therefore, iterate by 8 to get daily forecast value
    for ( var i = 0; i < weatherForecast.length; i += 8 ) {
        var weatherDescription = weatherForecast[i].weather[0].description;
        var weatherIconUrl = '<img src="' + owmIconUrl + weatherForecast[i].weather[0].icon + '.png">';
        var weatherDate = weatherForecast[i].dt_txt.substring(5, 10);

        var weatherValue = {
            date: weatherDate,
            icon: weatherIconUrl,
            desc: weatherDescription
        };
        weatherArray.push(weatherValue);
    }
    return weatherArray;
};

// Weather View Model
var weatherViewModel = function() {
    var self = this;

    self.weatherList = new weatherModel();
};


// Apply knockout bindings
ko.applyBindings(new weatherViewModel());
